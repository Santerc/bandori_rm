<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ block "title" . }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
    
    <script>
        (function() {
            // 1. è¯»å–æœ¬åœ°å­˜å‚¨
            const savedTheme = localStorage.getItem('theme');
            // 2. è¯»å–ç³»ç»Ÿåå¥½ (æ˜¯å¦æ˜¯æ·±è‰²æ¨¡å¼)
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // 3. ç«‹å³è®¾ç½®å±æ€§
            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                // å¦‚æœæ˜¯æµ…è‰²ï¼Œç§»é™¤å±æ€§ (æˆ–è€…æ˜¯ setAttribute('data-theme', 'light'))
                document.documentElement.removeAttribute('data-theme');
            }
        })();
    </script>

    <!-- æ ·å¼è¡¨ -->
    {{ $style := resources.Get "css/main.css" | minify }}
    <link rel="stylesheet" href="{{ $style.Permalink }}">

    <!-- Fuse.js æœç´¢åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
</head>
<body>
    <!-- ğŸ“± ç§»åŠ¨ç«¯é®ç½©å±‚ (ç‚¹å‡»å…³é—­ä¾§è¾¹æ ) -->
    <div id="mobile-backdrop"></div>
    <!-- 1. é¡¶éƒ¨é€šæ  -->
    {{ partial "header.html" . }}

    <!-- 2. æ ¸å¿ƒä¸‰æ ç½‘æ ¼ -->
    <div class="grid-container">
        <aside class="sidebar-left">
            {{ partial "sidebar-left.html" . }}
        </aside>

        <main class="main-content">
            {{ block "main" . }}{{ end }}
        </main>

        <aside class="sidebar-right">
            {{ partial "sidebar-right.html" . }}
        </aside>
    </div>

    <!-- 3. åº•éƒ¨ -->
    {{ partial "footer.html" . }}

    <!-- è„šæœ¬èµ„æº -->
    {{ $js := resources.Get "js/main.js" | minify }}
    <script src="{{ $js.Permalink }}"></script>

    {{ $cursor := resources.Get "js/cursor.js" | minify }}
    <script src="{{ $cursor.Permalink }}"></script>
    
    {{ $search := resources.Get "js/search.js" | minify }}
    <script src="{{ $search.Permalink }}"></script>
</body>
</html>
