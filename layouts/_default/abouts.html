{{ define "main" }}
<!-- ËøôÈáåÁöÑ styles Á°Æ‰øùÂç≥‰Ωø CSS Ê≤°Âà∑Êñ∞‰πüËÉΩÁî±Âü∫Êú¨ÁöÑÂ∏ÉÂ±Ä -->
<div class="about-container fade-up" style="max-width: 1000px; margin: 0 auto;">
    
    <!-- È°∂ÈÉ®Ôºö‰∏™‰∫∫Ê†∏ÂøÉ‰ø°ÊÅØÂç° -->
    <div class="about-header glass-panel" style="display: flex; align-items: center; gap: 2rem; padding: 2.5rem; margin-bottom: 2rem; border-radius: 16px;">
        <div class="about-avatar-wrapper">
            <img src="{{ .Params.avatar | default .Site.Params.home.avatar }}" alt="avatar" class="about-avatar" style="width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--primary); object-fit: cover;">
        </div>
        <div class="about-info">
            <h1 class="about-name" style="font-size: 2.2rem; font-weight: 800; margin-bottom: 0.5rem;">{{ .Params.nickname }}</h1>
            <p class="about-role" style="font-family: 'JetBrains Mono'; color: var(--primary); font-weight: bold; min-height: 1.5em;">
                // <span id="typing-role">{{ .Params.role }}</span><span class="cursor-blink">_</span>
            </p>
            <p class="about-loc" style="color: var(--text-muted);">üìç {{ .Params.location }}</p>
        </div>
    </div>

    <!-- ‰∏≠Èó¥Ôºö‰∏§Ê†èÂ∏ÉÂ±Ä -->
    <div class="about-grid" style="display: grid; grid-template-columns: 2fr 1.2fr; gap: 25px;">
        
        <!-- Â∑¶‰æßÂàó -->
        <div class="about-left-col" style="display: flex; flex-direction: column; gap: 20px;">
            <!-- Ëá™Êàë‰ªãÁªçÊ≠£Êñá -->
            <div class="about-bio glass-panel" style="padding: 2rem; border-radius: 12px;">
                <div class="panel-title" style="font-family: 'JetBrains Mono'; font-weight: bold; color: var(--text-muted); margin-bottom: 1rem; border-bottom: 1px dashed var(--border); padding-bottom: 5px;">// BIO_DATA</div>
                <div class="post-content">
                    {{ .Content }}
                </div>
            </div>

            <!-- Êñ∞Â¢ûÔºöÁä∂ÊÄÅÁõëÊéßÈù¢Êùø -->
            <div class="glass-panel" style="padding: 1.5rem; border-radius: 12px; position: relative; overflow: hidden;">
                <div class="panel-title" style="font-family: 'JetBrains Mono'; font-weight: bold; color: var(--text-muted); margin-bottom: 1rem; border-bottom: 1px dashed var(--border); padding-bottom: 5px;">// STATUS_MONITOR</div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <!-- Ëá™ÂÆö‰πâÁΩëÊòì‰∫ëÊí≠ÊîæÂô® -->
                    <div id="custom-player" class="music-player">
                        <!-- Â∞ÅÈù¢/Âî±Áâá -->
                        <div class="album-art" style="width: 50px; height: 50px; background: #333; border-radius: 50%; position: relative; overflow: hidden; flex-shrink: 0; box-shadow: 0 0 10px rgba(0,0,0,0.5);">
                            <img id="music-cover" src="" alt="cover" style="width: 100%; height: 100%; object-fit: cover; opacity: 0.8;">
                            <div class="vinyl-center" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 15px; height: 15px; background: #1a1a1a; border-radius: 50%; border: 2px solid rgba(255,255,255,0.1); z-index: 2;"></div>
                        </div>
                        
                        <!-- ‰ø°ÊÅØ‰∏éÊ≥¢ÂΩ¢ -->
                        <div class="track-info" style="flex-grow: 1; min-width: 0;">
                            <div id="music-title" style="font-size: 0.9rem; font-weight: bold; margin-bottom: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Loading...</div>
                            <div id="music-artist" style="font-size: 0.75rem; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">...</div>
                            
                            <!-- Âä®ÊÄÅÊ≥¢ÂΩ¢ -->
                            <div class="waveform" style="display: flex; align-items: flex-end; gap: 2px; height: 15px; margin-top: 5px;">
                                <div class="bar" style="width: 3px; height: 60%; background: var(--primary); animation: wave 0.5s infinite alternate;"></div>
                                <div class="bar" style="width: 3px; height: 90%; background: var(--primary); animation: wave 0.7s infinite alternate;"></div>
                                <div class="bar" style="width: 3px; height: 40%; background: var(--primary); animation: wave 0.6s infinite alternate;"></div>
                                <div class="bar" style="width: 3px; height: 70%; background: var(--primary); animation: wave 0.4s infinite alternate;"></div>
                                <div class="bar" style="width: 3px; height: 50%; background: var(--primary); animation: wave 0.8s infinite alternate;"></div>
                            </div>
                        </div>

                        <!-- Êí≠ÊîæÁä∂ÊÄÅÂõæÊ†á -->
                        <div class="play-status" style="font-size: 1.2rem; color: var(--primary);">
                            <i class="fas fa-play" id="play-icon">‚ñ∂</i>
                        </div>
                    </div>

                    <!-- Âä®ÊÄÅÁîüÊàêÁöÑ Audio Ê†áÁ≠æ -->
                    <audio id="bgm-audio" loop></audio>

                    <!-- Á≥ªÁªüÁä∂ÊÄÅÊ®°Êãü -->
                    <div class="sys-stats" style="display: flex; flex-direction: column; gap: 10px; justify-content: center;">
                        <div class="stat-row" style="display: flex; justify-content: space-between; font-size: 0.85rem; font-family: 'JetBrains Mono';">
                            <span style="color: var(--text-muted);">MOOD</span>
                            <span>‚òï Caffeinated</span>
                        </div>
                        <div class="stat-row" style="display: flex; justify-content: space-between; font-size: 0.85rem; font-family: 'JetBrains Mono';">
                            <span style="color: var(--text-muted);">STATUS</span>
                            <span style="color: #98c379;">‚óè Online</span>
                        </div>
                        <div class="stat-row" style="display: flex; justify-content: space-between; font-size: 0.85rem; font-family: 'JetBrains Mono';">
                            <span style="color: var(--text-muted);">WEATHER</span>
                            <span>üå§Ô∏è Sunny</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Âè≥‰æßÔºöÊäÄËÉΩ‰∏éË£ÖÂ§á -->
        <div class="about-stats" style="display: flex; flex-direction: column; gap: 20px;">
            <!-- 1. ÊäÄËÉΩÊù° -->
            {{ if .Params.skills }}
            <div class="glass-panel stat-box" style="padding: 1.5rem; border-radius: 12px;">
                <div class="panel-title" style="font-family: 'JetBrains Mono'; font-weight: bold; color: var(--text-muted); margin-bottom: 1rem; border-bottom: 1px dashed var(--border); padding-bottom: 5px;">// SKILL_TREE</div>
                <div class="skill-list" style="display: flex; flex-direction: column; gap: 15px;">
                    {{ range .Params.skills }}
                    <div class="skill-item" style="width: 100%;">
                        <div class="skill-info" style="display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 6px; font-family: 'JetBrains Mono';">
                            <span>{{ .name }}</span>
                            <span>{{ .percent }}%</span>
                        </div>
                        <div class="progress-bg" style="width: 100%; height: 8px; background: rgba(100,100,100,0.1); border-radius: 4px; overflow: hidden;">
                            <div class="progress-bar" style="height: 100%; width: {{ .percent }}%; background: var(--primary); border-radius: 4px;"></div>
                        </div>
                    </div>
                    {{ end }}
                </div>
            </div>
            {{ end }}

            <!-- 2. ÊäÄÊúØÊ†à -->
            {{ if .Params.stack }}
            <div class="glass-panel stat-box" style="padding: 1.5rem; border-radius: 12px;">
                <div class="panel-title" style="font-family: 'JetBrains Mono'; font-weight: bold; color: var(--text-muted); margin-bottom: 1rem; border-bottom: 1px dashed var(--border); padding-bottom: 5px;">// EQUIPMENT</div>
                <div class="tag-cloud">
                    {{ range .Params.stack }}
                    <span class="tech-tag">{{ . }}</span>
                    {{ end }}
                </div>
            </div>
            {{ end }}
        </div>
    </div>

    <!-- Â∫ïÈÉ®Ôºö‰∫§‰∫íÂºèÁªàÁ´Ø (New) -->
    <div class="terminal-section glass-panel">
        <div class="terminal-header">
            <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff5f56;"></div>
            <div style="width: 12px; height: 12px; border-radius: 50%; background: #ffbd2e;"></div>
            <div style="width: 12px; height: 12px; border-radius: 50%; background: #27c93f;"></div>
            <div style="margin-left: 10px; font-size: 0.8rem; color: #808080;">guest@santerc-blog:~</div>
        </div>
        <div class="terminal-body" id="terminal-output">
            <div class="terminal-line">Welcome to Santerc's Interactive Terminal v1.0.0</div>
            <div class="terminal-line">System initialized... OK</div>
            <div class="terminal-line">Type <span style="color: var(--primary);">'help'</span> to see available commands.</div>
            <br>
            <div class="input-line" style="display: flex; gap: 10px; align-items: center;">
                <span style="color: var(--primary);">‚ûú</span>
                <span style="color: #98c379;">~</span>
                <input type="text" id="terminal-input" style="background: transparent; border: none; color: inherit; font-family: inherit; flex-grow: 1; outline: none;" autocomplete="off">
            </div>
        </div>
    </div>
</div>

<style>
    /* --- Terminal Styles (Always Dark Theme) --- */
    .terminal-section {
        margin-top: 25px;
        padding: 0;
        border-radius: 12px;
        overflow: hidden;
        font-family: 'JetBrains Mono', monospace;
        border: 1px solid rgba(0,0,0,0.1);
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .terminal-header {
        background: #2d2d2d; /* Always dark header */
        padding: 10px 15px;
        display: flex;
        gap: 8px;
        align-items: center;
        border-bottom: 1px solid #3d3d3d;
    }
    .terminal-body {
        padding: 20px;
        min-height: 250px;
        background: #1e1e1e; /* Always dark body */
        color: #a9b7c6;       /* Always light text */
        font-size: 0.9rem;
        overflow-y: auto;
        max-height: 400px;
    }
    
    /* --- Music Player Styles --- */
    .music-player {
        padding: 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        /* Light Mode Default */
        background: rgba(0,0,0,0.05); 
        border: 1px solid rgba(0,0,0,0.05);
    }
    
    /* Dark Mode Overrides */
    [data-theme='dark'] .music-player {
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.05);
    }

    .cursor-blink {
        animation: blink 1s step-end infinite;
    }
    @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
    }
    @keyframes wave {
        0% { height: 20%; }
        100% { height: 100%; }
    }
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    
    /* ÈªòËÆ§ÊöÇÂÅúÂä®Áîª */
    .waveform .bar {
        animation-play-state: paused;
    }
    .album-art img {
        animation: spin 10s linear infinite;
        animation-play-state: paused;
    }

    /* Êí≠ÊîæÊó∂ËøêË°åÂä®Áîª */
    .music-player.playing .waveform .bar {
        animation-play-state: running;
    }
    .music-player.playing .album-art img {
        animation-play-state: running;
    }
    .music-player:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .terminal-line {
        margin-bottom: 5px;
        line-height: 1.5;
    }
    .command-output {
        color: #e0e0e0;
        margin-bottom: 10px;
        white-space: pre-wrap;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // --- Music Player Logic ---
    const player = document.getElementById('custom-player');
    const audio = document.getElementById('bgm-audio');
    const playIcon = document.getElementById('play-icon');
    const titleElem = document.getElementById('music-title');
    const artistElem = document.getElementById('music-artist');
    const coverElem = document.getElementById('music-cover');

    // 1. Build Playlist
    const playlist = [];
    {{ if .Params.playlist }}
        {{ range .Params.playlist }}
        playlist.push({
            title: "{{ .title }}",
            artist: "{{ .artist }}",
            cover: "{{ .cover }}",
            theme: "{{ .theme }}",
            url: "{{ if .url }}{{ .url | relURL }}{{ else }}https://music.163.com/song/media/outer/url?id={{ .id }}.mp3{{ end }}"
        });
        {{ end }}
    {{ else }}
        // Fallback
        playlist.push({
            title: "{{ .Params.music_title | default "Unknown" }}",
            artist: "{{ .Params.music_artist | default "Unknown" }}",
            cover: "{{ .Params.music_cover | default "" }}",
            url: "{{ if .Params.music_url }}{{ .Params.music_url | relURL }}{{ else }}https://music.163.com/song/media/outer/url?id={{ .Params.music_id | default "1901371647" }}.mp3{{ end }}"
        });
    {{ end }}

    let currentTrackIndex = 0;

    function loadTrack(index) {
        if (index < 0 || index >= playlist.length) return;
        const track = playlist[index];
        currentTrackIndex = index;
        
        if(titleElem) titleElem.textContent = track.title;
        if(artistElem) artistElem.textContent = track.artist;
        if(coverElem) coverElem.src = track.cover || "https://p1.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg";
        if(audio) audio.src = track.url;
    }

    function playTrack(index) {
        loadTrack(index);
        if(audio) {
            audio.play().then(() => {
                if(player) player.classList.add('playing');
                if(playIcon) playIcon.textContent = '‚è∏';
            }).catch(e => {
                console.error("Play failed", e);
                if(playIcon) playIcon.textContent = '‚úñ';
            });
        }
    }

    // Initialize
    if (playlist.length > 0) {
        // Check theme
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        let defaultIndex = 0;
        
        // Find first matching theme
        const themeMatchIndex = playlist.findIndex(t => t.theme === (isDark ? 'dark' : 'light'));
        if (themeMatchIndex !== -1) {
            defaultIndex = themeMatchIndex;
        }
        
        loadTrack(defaultIndex);
    }

    // Player Click Event
    if(player && audio) {
        player.addEventListener('click', function() {
            if (audio.paused) {
                audio.play().then(() => {
                    player.classList.add('playing');
                    playIcon.textContent = '‚è∏';
                }).catch(e => console.error(e));
            } else {
                audio.pause();
                player.classList.remove('playing');
                playIcon.textContent = '‚ñ∂';
            }
        });
        
        audio.addEventListener('ended', function() {
             if(!audio.loop) {
                player.classList.remove('playing');
                playIcon.textContent = '‚ñ∂';
             }
        });
    }

    // --- Typing Effect ---
    const roleElement = document.getElementById('typing-role');
    const roles = ["{{ .Params.role }}", "Embedded Engineer", "Open Source Enthusiast", "Student"];
    let roleIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    let typeSpeed = 100;

    function typeRole() {
        const currentRole = roles[roleIndex];
        
        if (isDeleting) {
            roleElement.textContent = currentRole.substring(0, charIndex - 1);
            charIndex--;
            typeSpeed = 50;
        } else {
            roleElement.textContent = currentRole.substring(0, charIndex + 1);
            charIndex++;
            typeSpeed = 100;
        }

        if (!isDeleting && charIndex === currentRole.length) {
            isDeleting = true;
            typeSpeed = 2000; // Pause at end
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            roleIndex = (roleIndex + 1) % roles.length;
            typeSpeed = 500; // Pause before typing next
        }

        setTimeout(typeRole, typeSpeed);
    }
    
    // Start typing effect if element exists
    if(roleElement) {
        // Initialize with first role immediately
        roleElement.textContent = roles[0];
        charIndex = roles[0].length;
        isDeleting = true;
        setTimeout(typeRole, 2000);
    }

    // --- Snake Game Logic ---
    const snakeGame = {
        isRunning: false,
        timer: null,
        width: 30,
        height: 15,
        snake: [],
        direction: {x: 1, y: 0},
        food: {x: 0, y: 0},
        score: 0,
        gameDiv: null,

        start: function() {
            this.isRunning = true;
            this.snake = [{x: 5, y: 5}, {x: 4, y: 5}, {x: 3, y: 5}];
            this.direction = {x: 1, y: 0};
            this.score = 0;
            this.spawnFood();
            
            // Hide terminal content
            Array.from(terminalOutput.children).forEach(c => c.style.display = 'none');
            
            // Create game container
            this.gameDiv = document.createElement('div');
            this.gameDiv.style.fontFamily = "'JetBrains Mono', monospace";
            this.gameDiv.style.lineHeight = "1.2";
            this.gameDiv.style.whiteSpace = "pre";
            this.gameDiv.style.color = "#98c379";
            this.gameDiv.style.textAlign = "center";
            terminalOutput.appendChild(this.gameDiv);
            
            terminalInput.blur(); // Remove focus from input
            
            this.timer = setInterval(() => this.update(), 200);
            window.addEventListener('keydown', this.handleInput);
        },

        stop: function() {
            this.isRunning = false;
            clearInterval(this.timer);
            window.removeEventListener('keydown', this.handleInput);
            
            if(this.gameDiv) {
                this.gameDiv.remove();
                this.gameDiv = null;
            }
            
            // Show terminal content
            Array.from(terminalOutput.children).forEach(c => c.style.display = '');
            terminalInput.focus();
            
            // Print game over message
            const outputDiv = document.createElement('div');
            outputDiv.className = 'command-output';
            outputDiv.innerHTML = `Game Over! Score: ${this.score}`;
            terminalOutput.insertBefore(outputDiv, inputLine);
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        },

        handleInput: function(e) {
            if(!snakeGame.isRunning) return;
            
            switch(e.key) {
                case 'ArrowUp': case 'w': if(snakeGame.direction.y === 0) snakeGame.direction = {x: 0, y: -1}; break;
                case 'ArrowDown': case 's': if(snakeGame.direction.y === 0) snakeGame.direction = {x: 0, y: 1}; break;
                case 'ArrowLeft': case 'a': if(snakeGame.direction.x === 0) snakeGame.direction = {x: -1, y: 0}; break;
                case 'ArrowRight': case 'd': if(snakeGame.direction.x === 0) snakeGame.direction = {x: 1, y: 0}; break;
                case 'q': case 'Escape': snakeGame.stop(); break;
            }
            e.preventDefault(); // Prevent scrolling
        },

        spawnFood: function() {
            let valid = false;
            while(!valid) {
                this.food = {
                    x: Math.floor(Math.random() * this.width),
                    y: Math.floor(Math.random() * this.height)
                };
                valid = !this.snake.some(s => s.x === this.food.x && s.y === this.food.y);
            }
        },

        update: function() {
            const head = {x: this.snake[0].x + this.direction.x, y: this.snake[0].y + this.direction.y};
            
            // Check collision
            if(head.x < 0 || head.x >= this.width || head.y < 0 || head.y >= this.height || 
               this.snake.some(s => s.x === head.x && s.y === head.y)) {
                this.stop();
                return;
            }
            
            this.snake.unshift(head);
            
            if(head.x === this.food.x && head.y === this.food.y) {
                this.score += 10;
                this.spawnFood();
            } else {
                this.snake.pop();
            }
            
            this.draw();
        },

        draw: function() {
            let output = `SNAKE GAME - Score: ${this.score} (Press 'q' to quit)\n`;
            output += '+' + '-'.repeat(this.width) + '+\n';
            
            for(let y=0; y<this.height; y++) {
                output += '|';
                for(let x=0; x<this.width; x++) {
                    if(this.snake[0].x === x && this.snake[0].y === y) output += 'O';
                    else if(this.snake.some(s => s.x === x && s.y === y)) output += 'o';
                    else if(this.food.x === x && this.food.y === y) output += '*';
                    else output += ' ';
                }
                output += '|\n';
            }
            output += '+' + '-'.repeat(this.width) + '+';
            
            if(this.gameDiv) this.gameDiv.textContent = output;
        }
    };
    // Bind handleInput context
    snakeGame.handleInput = snakeGame.handleInput.bind(snakeGame);

    // --- Terminal Logic ---
    const terminalInput = document.getElementById('terminal-input');
    const terminalOutput = document.getElementById('terminal-output');
    const inputLine = document.querySelector('.input-line');

    if (terminalInput) {
        terminalInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const fullCommand = this.value.trim();
                const parts = fullCommand.split(/\s+/);
                const cmd = parts[0].toLowerCase();
                
                // Create command history line
                const historyLine = document.createElement('div');
                historyLine.className = 'terminal-line';
                historyLine.innerHTML = `<span style="color: var(--primary);">‚ûú</span> <span style="color: #98c379;">~</span> ${fullCommand}`;
                terminalOutput.insertBefore(historyLine, inputLine);

                // Process command
                let output = '';
                switch(cmd) {
                    case 'help':
                        output = `Available commands:
  <span style="color: var(--primary)">help</span>      - Show this help message
  <span style="color: var(--primary)">whoami</span>    - Display user info
  <span style="color: var(--primary)">skills</span>    - List technical skills
  <span style="color: var(--primary)">music</span>     - Control music player
  <span style="color: var(--primary)">snake</span>     - Play Snake game (Easter Egg!)
  <span style="color: var(--primary)">contact</span>   - Show contact info
  <span style="color: var(--primary)">clear</span>     - Clear terminal
  <span style="color: var(--primary)">date</span>      - Show current date`;
                        break;
                    case 'snake':
                        snakeGame.start();
                        this.value = ''; // Clear input
                        return; // Skip default output handling
                    case 'music':
                        const subCmd = parts[1] ? parts[1].toLowerCase() : 'list';
                        
                        if (subCmd === 'list') {
                            output = "Playlist:\n";
                            playlist.forEach((track, i) => {
                                const marker = (i === currentTrackIndex) ? "*" : " ";
                                output += `${marker} [${i}] ${track.title} - ${track.artist}\n`;
                            });
                        } else if (subCmd === 'play') {
                            const idx = parseInt(parts[2]);
                            if (!isNaN(idx) && idx >= 0 && idx < playlist.length) {
                                playTrack(idx);
                                output = `Playing: ${playlist[idx].title}`;
                            } else {
                                output = "Invalid track index. Usage: music play <index>";
                            }
                        } else if (subCmd === 'next') {
                            const nextIdx = (currentTrackIndex + 1) % playlist.length;
                            playTrack(nextIdx);
                            output = `Playing next: ${playlist[nextIdx].title}`;
                        } else if (subCmd === 'prev') {
                            const prevIdx = (currentTrackIndex - 1 + playlist.length) % playlist.length;
                            playTrack(prevIdx);
                            output = `Playing prev: ${playlist[prevIdx].title}`;
                        } else if (subCmd === 'stop') {
                            if(audio) audio.pause();
                            if(player) player.classList.remove('playing');
                            if(playIcon) playIcon.textContent = '‚ñ∂';
                            output = "Music stopped.";
                        } else {
                            output = "Usage: music [list|play <index>|next|prev|stop]";
                        }
                        break;
                    case 'whoami':
                        output = "User: {{ .Params.nickname }}\nRole: {{ .Params.role }}\nLocation: {{ .Params.location }}";
                        break;
                    case 'skills':
                        output = "Loaded Skills:\n";
                        {{ range .Params.skills }}
                        output += "  - {{ .name }} [{{ .percent }}%]\n";
                        {{ end }}
                        break;
                    case 'contact':
                        output = "GitHub: https://github.com/{{ .Params.nickname }}\nEmail: (Hidden for privacy)";
                        break;
                    case 'date':
                        output = new Date().toString();
                        break;
                    case 'clear':
                        // Remove all previous siblings of inputLine
                        while(terminalOutput.firstChild && terminalOutput.firstChild !== inputLine) {
                            terminalOutput.removeChild(terminalOutput.firstChild);
                        }
                        this.value = '';
                        return; // Exit early
                    case '':
                        output = '';
                        break;
                    default:
                        output = `Command not found: ${cmd}. Type 'help' for available commands.`;
                }

                if (output) {
                    const outputDiv = document.createElement('div');
                    outputDiv.className = 'command-output';
                    outputDiv.innerHTML = output;
                    terminalOutput.insertBefore(outputDiv, inputLine);
                }

                // Clear input and scroll to bottom
                this.value = '';
                terminalOutput.scrollTop = terminalOutput.scrollHeight;
            }
        });

        // Focus input when clicking anywhere in terminal
        document.querySelector('.terminal-section').addEventListener('click', function() {
            terminalInput.focus();
        });
    }
});
</script>
{{ end }}
